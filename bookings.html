<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bookings - Precious Meals & Bakes</title>
    <meta name="description" content="Book your catering services with Precious Meals & Bakes">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Baskerville&display=swap" rel="stylesheet">
    <!-- AOS Animation Library -->
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="./css/style.css" rel="stylesheet">
    <!-- Calendar CSS -->
    <link href="./css/calendar.css" rel="stylesheet">
    <!-- Admin CSS -->
    <link href="./css/admin.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <style>
        body {
            font-family: 'Baskerville', serif;
            background: url('./img/image26.jpg') no-repeat center center fixed;
            background-size: cover;
            background-attachment: fixed;
            margin: 0;
            padding: 0;
            scroll-behavior: smooth;
        }

        /* Header Styling */
        header {
            position: relative;
            background: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .navbar {
            position: sticky;
            top: 0;
            width: 100%;
            background-color: #B9484E;
            color: white;
            padding: 8px 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 900;
            height: 50px;
        }

        .navbar-brand img {
            height: 40px;
            margin-right: 10px;
        }

        .navbar-nav .nav-link {
            color: #fff;
            font-weight: bold;
            margin: 0 10px;
            font-size: 0.9rem;
        }

        .navbar-nav .nav-link:hover {
            color: #d8bc70;
        }

        .navbar-nav .active {
            color: #d8bc70 !important;
        }

        /* Highlight text color */
        .highlight-text {
            color: #d8bc70;
        }

        /* Form Styling */
        .form-container {
            margin: 50px auto;
            padding: 40px;
            max-width: 600px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .form-section .mb-3 {
            margin-bottom: 1rem;
        }

        .form-label {
            font-weight: bold;
            color: #333;
        }

        .btn-primary {
            background-color: #af8958;
            border: none;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #d8bc70;
            transform: scale(1.02);
        }

        /* Call button styling */
        .call-btn {
            background-color: #d8bc70;
            color: white;
            font-weight: bold;
            border-radius: 25px;
            padding: 5px 20px;
            font-size: 14px;
            text-decoration: none;
        }

        .call-btn:hover {
            background-color: #c9ad61;
            color: white;
        }

        /* Card and section styling */
        .card {
            border: none;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        /* Footer styling */
        footer {
            background-color: #B9484E;
            color: white;
            padding: 40px 0 20px;
        }

        footer a.text-white {
            text-decoration: none;
        }

        footer a.text-white:hover {
            color: #d8bc70 !important;
            text-decoration: underline;
        }

        /* Social links */
        .social-links a {
            color: white;
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .social-links a:hover {
            color: #d8bc70;
        }

        /* My Bookings table */
        .bookings-table {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        /* AOS animations */
        [data-aos] {
            pointer-events: none;
        }

        [data-aos].aos-animate {
            pointer-events: auto;
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand" href="./index.html">
                    <img src="./img/pmb.png" alt="Precious Meals & Bakes Logo">
                    <b class="highlight-text">Precious Meals & Bakes</b>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="./index.html">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./about-us.html">About Us</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#myBookings">My Bookings</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./services.html">Services</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./gallery.html">Gallery</a>
                        </li>                        
                        <li class="nav-item">
                            <a class="nav-link active" href="./bookings.html">Book Today</a>
                        </li>
                    </ul>
                    <!-- Auth buttons (shown when logged out) -->
                    <div class="auth-buttons">
                        <button type="button" class="btn btn-outline-light me-2" data-bs-toggle="modal" data-bs-target="#authModal" id="navLoginBtn">
                            <i class="bi bi-box-arrow-in-right me-1"></i> Login
                        </button>
                        <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#authModal" id="navRegisterBtn">
                            <i class="bi bi-person-plus me-1"></i> Register
                        </button>
                    </div>
                    <!-- User menu (shown when logged in) -->
                    <div class="user-menu d-none">
                        <div class="dropdown">
                            <button class="btn btn-secondary dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-person-circle me-1"></i> <span class="user-name">User</span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                <li><a class="dropdown-item" href="#" id="viewBookingsBtn">My Bookings</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" id="logoutBtn">Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Page Title -->
    <div class="container py-5">
        <div class="row">
            <div class="col-12 text-center" data-aos="fade-up">
                <h1 class="mb-4">Book Your <span class="highlight-text">Event</span></h1>
                <p class="lead">Fill out the form below to request catering services for your special occasion</p>
            </div>
        </div>
    </div>

    <!-- Booking Section -->
    <section id="booking" style="background-color: rgba(255, 255, 255, 0.8); padding: 30px 0; border-radius: 10px;">
        <div class="container py-5">
            <!-- Success Message -->
            <div id="bookingSuccessMessage" class="alert alert-success text-center mb-4 d-none">
                <i class="bi bi-check-circle-fill me-2"></i> Your booking request has been submitted successfully! We will contact you shortly to confirm your booking.
            </div>

            <!-- Login Prompt (shown when not logged in) -->
            <div id="loginPrompt" class="text-center mb-5 d-none">
                <div class="card shadow p-4" data-aos="fade-up">
                    <div class="card-body">
                        <h3 class="card-title mb-4">Login Required</h3>
                        <p class="card-text">Please log in or register to make a booking.</p>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#authModal">
                            <i class="bi bi-box-arrow-in-right me-2"></i> Login / Register
                        </button>
                    </div>
                </div>
            </div>

            <!-- Active Bookings Calendar (Hidden by default) -->
            <div id="bookingsCalendarContainer" class="d-none mb-5">
                <div class="card shadow">
                    <div class="card-body">
                        <h3 class="card-title mb-4"><i class="bi bi-calendar-week me-2"></i>Active Bookings Calendar</h3>
                        <div id="bookingsCalendar" class="calendar-container">
                            <div class="calendar-header">
                                <button id="prevMonthBtn" class="calendar-nav-btn"><i class="bi bi-chevron-left"></i></button>
                                <h3 id="calendarMonth">May 2025</h3>
                                <button id="nextMonthBtn" class="calendar-nav-btn"><i class="bi bi-chevron-right"></i></button>
                            </div>
                            <div class="calendar-grid" id="calendarDaysHeader">
                                <div class="calendar-day-header">Sun</div>
                                <div class="calendar-day-header">Mon</div>
                                <div class="calendar-day-header">Tue</div>
                                <div class="calendar-day-header">Wed</div>
                                <div class="calendar-day-header">Thu</div>
                                <div class="calendar-day-header">Fri</div>
                                <div class="calendar-day-header">Sat</div>
                            </div>
                            <div class="calendar-grid" id="calendarDays">
                                <!-- Calendar days will be generated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Booking Form -->
            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <!-- Login Prompt (shown when logged out) -->
                    <div class="card shadow" id="loginPrompt" data-aos="fade-up" data-aos-delay="100">
                        <div class="card-body p-5 text-center">
                            <h2 class="card-title text-center mb-4">Book Your Event</h2>
                            <div class="mb-4">
                                <i class="bi bi-lock-fill" style="font-size: 3rem; color: #af8958;"></i>
                                <p class="lead mt-3">Please login or create an account to make a booking</p>
                                <p class="text-muted">You need to be logged in to access our booking system</p>
                            </div>
                            <div class="d-grid gap-2 col-lg-6 mx-auto">
                                <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#authModal" id="promptLoginBtn">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>Login
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-lg" data-bs-toggle="modal" data-bs-target="#authModal" id="promptRegisterBtn">
                                    <i class="bi bi-person-plus me-2"></i>Create Account
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Booking Form Card (hidden until logged in) -->
                    <div class="card shadow d-none" id="bookingFormCard" data-aos="fade-up" data-aos-delay="100">
                        <div class="card-body p-5">
                            <h2 class="card-title text-center mb-4">Booking Form</h2>
                            
                            <!-- Availability Message -->
                            <div id="availabilityMessage" class="alert alert-warning mb-4 d-none"></div>
                            
                            <!-- Booking Form -->
                            <form id="bookingForm">

                                
                                <!-- Personal Information -->
                                <div class="mb-4">
                                    <h5>Personal Information</h5>
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label for="fullName" class="form-label">Full Name*</label>
                                            <input type="text" class="form-control" id="fullName" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="email" class="form-label">Email Address*</label>
                                            <input type="email" class="form-control" id="email" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="phone" class="form-label">Phone Number*</label>
                                            <input type="tel" class="form-control" id="phone" required>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Event Information -->
                                <div class="mb-4">
                                    <h5>Event Information</h5>
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label for="eventType" class="form-label">Event Type*</label>
                                            <select class="form-select" id="eventType" required>
                                                <option value="" selected disabled>Select event type</option>
                                                <option value="Wedding">Wedding</option>
                                                <option value="Roora/Lobola">Roora/Lobola Ceremony</option>
                                                <option value="Corporate Event">Corporate Event</option>
                                                <option value="Business Lunch">Business Lunch</option>
                                                <option value="Conference Catering">Conference Catering</option>
                                                <option value="Private Party">Private Party</option>
                                                <option value="Birthday Party">Birthday Party</option>
                                                <option value="Anniversary">Anniversary</option>
                                                <option value="Graduation">Graduation</option>
                                                <option value="Baby Shower">Baby Shower</option>
                                                <option value="Bridal Shower">Bridal Shower</option>
                                                <option value="Family Gathering">Family Gathering</option>
                                                <option value="Holiday Event">Holiday Event</option>
                                                <option value="Other">Other (Please specify in Special Requests)</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="guestCount" class="form-label">Number of Guests*</label>
                                            <input type="number" class="form-control" id="guestCount" min="10" max="500" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="eventDate" class="form-label">Event Date*</label>
                                            <input type="date" class="form-control" id="eventDate" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="timeSlot" class="form-label">Time Slot*</label>
                                            <select class="form-select" id="timeSlot" required>
                                                <option value="" selected disabled>Select date first</option>
                                            </select>
                                        </div>
                                        <div class="col-12">
                                            <label for="specialRequests" class="form-label">Special Requests</label>
                                            <textarea class="form-control" id="specialRequests" rows="4" placeholder="Please list any dietary requirements, special needs, or other requests"></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Terms and Submit -->
                                <div class="form-check mb-4">
                                    <input class="form-check-input" type="checkbox" id="termsCheck" required>
                                    <label class="form-check-label" for="termsCheck">
                                        I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">terms and conditions</a>
                                    </label>
                                </div>
                                
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary btn-lg px-5">
                                        <i class="bi bi-calendar-check me-2"></i>Submit Booking Request
                                    </button>
                                    <button type="button" id="viewMyBookingsBtn" class="btn btn-outline-secondary ms-2">
                                        <i class="bi bi-calendar3 me-2"></i>My Bookings
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Bookings Calendar Section (Hidden by default) -->
    <section id="bookingsCalendarContainer" class="container py-5 d-none">
        <div class="row">
            <div class="col-12 mb-4">
                <h3 class="text-center"><i class="bi bi-calendar3-week me-2"></i>Bookings Calendar</h3>
                <p class="text-center text-muted">View availability and your upcoming bookings</p>
            </div>
            <div class="col-lg-10 mx-auto">
                <div class="card shadow">
                    <div class="card-body p-0">
                        <div class="calendar-container">
                            <div class="calendar-header">
                                <button id="prevMonth" class="btn btn-sm btn-outline-secondary"><i class="bi bi-chevron-left"></i></button>
                                <h4 id="currentMonthYear">January 2025</h4>
                                <button id="nextMonth" class="btn btn-sm btn-outline-secondary"><i class="bi bi-chevron-right"></i></button>
                            </div>
                            <div class="calendar-weekdays">
                                <div>Sun</div>
                                <div>Mon</div>
                                <div>Tue</div>
                                <div>Wed</div>
                                <div>Thu</div>
                                <div>Fri</div>
                                <div>Sat</div>
                            </div>
                            <div id="calendarDays" class="calendar-days">
                                <!-- Calendar days will be generated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- My Bookings & Admin Section (Hidden by default) -->
    <section id="myBookingsContainer" class="container py-5 d-none">
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-calendar3 me-2"></i>My Bookings</h2>
                    <button id="backToBookingBtn" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-left me-2"></i>Back to Booking
                    </button>
                </div>
                
                <!-- No Bookings Message -->
                <div id="noBookingsMessage" class="alert alert-info text-center d-none">
                    <i class="bi bi-info-circle me-2"></i> You don't have any bookings yet.
                </div>
                
                <!-- Bookings Table -->
                <div class="table-responsive bookings-table">
                    <table class="table table-hover" id="bookingsTable">
                        <thead class="table-light">
                            <tr>
                                <th>Event Date</th>
                                <th>Event Type</th>
                                <th>Time</th>
                                <th>Guests</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="bookingsList">
                            <!-- Booking rows will be added here by JS -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Admin Panel (only visible for admin@admin.com) -->
                <div id="adminPanel" class="admin-panel mt-5 d-none">
                    <div class="admin-header">
                        <h3><i class="bi bi-shield-lock me-2"></i>Admin Panel</h3>
                    </div>
                    <div class="admin-body">
                        <ul class="nav nav-tabs admin-tabs" id="adminTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="allBookings-tab" data-bs-toggle="tab" data-bs-target="#allBookings" type="button" role="tab" aria-controls="allBookings" aria-selected="true">
                                    <i class="bi bi-calendar-check me-2"></i>All Bookings
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="pendingReviews-tab" data-bs-toggle="tab" data-bs-target="#pendingReviews" type="button" role="tab" aria-controls="pendingReviews" aria-selected="false">
                                    <i class="bi bi-star me-2"></i>Pending Reviews
                                </button>
                            </li>
                        </ul>
                        <div class="tab-content" id="adminTabsContent">
                            <!-- All Bookings Tab -->
                            <div class="tab-pane fade show active" id="allBookings" role="tabpanel" aria-labelledby="allBookings-tab">
                                <div class="table-responsive">
                                    <table class="table table-hover admin-table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Customer</th>
                                                <th>Contact</th>
                                                <th>Event Type</th>
                                                <th>Guests</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="allBookingsList">
                                            <!-- All bookings will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- Pending Reviews Tab -->
                            <div class="tab-pane fade" id="pendingReviews" role="tabpanel" aria-labelledby="pendingReviews-tab">
                                <div class="table-responsive">
                                    <table class="table table-hover admin-table">
                                        <thead>
                                            <tr>
                                                <th>Customer</th>
                                                <th>Event Type</th>
                                                <th>Rating</th>
                                                <th>Review</th>
                                                <th>Date</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="pendingReviewsList">
                                            <!-- Pending reviews will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Review Submission Section -->
    <section id="reviewSection" class="container py-5 d-none">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="card shadow">
                    <div class="card-body p-5">
                        <h2 class="card-title text-center mb-4"><i class="bi bi-star me-2"></i>Leave a Review</h2>
                        
                        <!-- Review Success Message -->
                        <div id="reviewSuccessMessage" class="alert alert-success text-center mb-4 d-none">
                            <i class="bi bi-check-circle-fill me-2"></i> Thank you for your review! It will be visible after approval.
                        </div>
                        
                        <!-- Review Form -->
                        <form id="reviewForm">
                            <div class="mb-4">
                                <label class="form-label">Your Rating</label>
                                <div class="rating mb-3">
                                    <input type="radio" id="star5" name="rating" value="5" />
                                    <label for="star5" title="5 stars"></label>
                                    <input type="radio" id="star4" name="rating" value="4" />
                                    <label for="star4" title="4 stars"></label>
                                    <input type="radio" id="star3" name="rating" value="3" />
                                    <label for="star3" title="3 stars"></label>
                                    <input type="radio" id="star2" name="rating" value="2" />
                                    <label for="star2" title="2 stars"></label>
                                    <input type="radio" id="star1" name="rating" value="1" />
                                    <label for="star1" title="1 star"></label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="reviewEventType" class="form-label">Event Type</label>
                                <select class="form-select" id="reviewEventType" required>
                                    <option value="" selected disabled>Select event type</option>
                                    <option value="Wedding">Wedding</option>
                                    <option value="Corporate Event">Corporate Event</option>
                                    <option value="Birthday Party">Birthday Party</option>
                                    <option value="Anniversary">Anniversary</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="reviewText" class="form-label">Your Review</label>
                                <textarea class="form-control" id="reviewText" rows="5" placeholder="Share your experience with our services..." required></textarea>
                            </div>
                            <div class="text-center">
                                <button type="submit" class="btn btn-primary btn-lg px-5">
                                    <i class="bi bi-send me-2"></i>Submit Review
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Authentication Modal -->
    <div class="modal fade" id="authModal" tabindex="-1" aria-labelledby="authModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="authModalLabel">Login to Your Account</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Auth Message -->
                    <div id="authMessage" class="alert d-none"></div>
                    
                    <!-- Login Form -->
                    <div id="loginFormContainer">
                        <form id="loginForm">
                            <div class="mb-3">
                                <label for="loginEmail" class="form-label">Email</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                                    <input type="email" class="form-control" id="loginEmail" placeholder="your@email.com" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="loginPassword" class="form-label">Password</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-key"></i></span>
                                    <input type="password" class="form-control" id="loginPassword" placeholder="Your password" required>
                                </div>
                            </div>
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>Login
                                </button>
                            </div>
                        </form>
                        <hr>
                        <p class="text-center">Don't have an account? <a href="#" id="showRegisterBtn" class="fw-bold">Create Account</a></p>
                    </div>
                    
                    <!-- Register Form -->
                    <div id="registerFormContainer" class="d-none">
                        <form id="registerForm">
                            <div class="mb-3">
                                <label for="registerName" class="form-label">Full Name</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-person"></i></span>
                                    <input type="text" class="form-control" id="registerName" placeholder="Your full name" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="registerEmail" class="form-label">Email</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                                    <input type="email" class="form-control" id="registerEmail" placeholder="your@email.com" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="registerPhone" class="form-label">Phone Number</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-telephone"></i></span>
                                    <input type="tel" class="form-control" id="registerPhone" placeholder="Your phone number" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="registerPassword" class="form-label">Password</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-key"></i></span>
                                    <input type="password" class="form-control" id="registerPassword" placeholder="Minimum 6 characters" required minlength="6">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="confirmPassword" class="form-label">Confirm Password</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-key-fill"></i></span>
                                    <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm your password" required minlength="6">
                                </div>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="termsCheck" required>
                                <label class="form-check-label" for="termsCheck">
                                    I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">Terms and Conditions</a>
                                </label>
                            </div>
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="bi bi-person-plus me-2"></i>Create Account
                                </button>
                            </div>
                        </form>
                        <hr>
                        <p class="text-center">Already have an account? <a href="#" id="showLoginBtn" class="fw-bold">Login</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Booking Details Modal -->
    <div class="modal fade" id="bookingDetailsModal" tabindex="-1" aria-labelledby="bookingDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="bookingDetailsModalLabel">Booking Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="bookingDetailsContent">
                        <!-- Booking details will be added here by JS -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Terms Modal -->
    <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="termsModalLabel">Terms and Conditions</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6>Booking Terms</h6>
                    <p>By making a booking with Precious Meals & Bakes, you agree to the following terms:</p>
                    <ul>
                        <li>All bookings are subject to availability and confirmation</li>
                        <li>A 50% deposit is required to secure your booking</li>
                        <li>Cancellations must be made at least 72 hours in advance for a full refund</li>
                        <li>Final guest count must be confirmed 48 hours before the event</li>
                        <li>Any changes to the menu must be requested at least 5 days before the event</li>
                        <li>Pricing is subject to change based on specific requirements and seasonal availability</li>
                    </ul>
                    <h6>Privacy Policy</h6>
                    <p>We respect your privacy and will only use your information to process your booking and to communicate with you about your event. We will never share your personal information with third parties without your consent.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">I Understand</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="pt-5 pb-3">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5>Precious Meals & Bakes</h5>
                    <p>Your premier catering partner for all occasions. We serve with passion and dedication.</p>
                    <div class="social-links mt-3">
                        <a href="https://www.facebook.com/preciousmealsnbakes/" aria-label="Facebook"><i class="bi bi-facebook"></i></a>
                        <a href="https://www.instagram.com/iamazwchef/" aria-label="Instagram"><i class="bi bi-instagram"></i></a>
                        <a href="https://www.tiktok.com/@preciousmeals3" aria-label="TikTok"><i class="bi bi-tiktok"></i></a>
                        <a href="https://wa.me/c/263719448084" aria-label="WhatsApp"><i class="bi bi-whatsapp"></i></a>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="./index.html" class="text-white">Home</a></li>
                        <li><a href="./about-us.html" class="text-white">About Us</a></li>
                        <li><a href="./services.html" class="text-white">Services</a></li>
                        <li><a href="./gallery.html" class="text-white">Gallery</a></li>
                        <li><a href="./bookings.html" class="text-white">Book Today</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Contact Us</h5>
                    <p><i class="bi bi-telephone-fill me-2"></i> <a href="tel:+263719448084" class="text-white">+263 719 448 084</a></p>
                    <p><i class="bi bi-envelope-fill me-2"></i> <a href="mailto:preciousmealszw@gmail.com" class="text-white">preciousmealszw@gmail.com</a></p>
                    <p><i class="bi bi-geo-alt-fill me-2"></i> Harare, Zimbabwe</p>
                </div>
            </div>
            <hr class="my-4 bg-white">
            <div class="text-center">
                <p>&copy; 2025 Precious Meals & Bakes. All Rights Reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- AOS Animation Library -->
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <!-- Main Script -->
    <script src="./js/script.js"></script>
    <!-- Firebase SDK -->
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getFirestore } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
      import { getAuth } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
      
      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyAPK6cVmWAw-c55-npz1R5_VGGyFKYQ3gw",
        authDomain: "preciousmeals-a7d59.firebaseapp.com",
        projectId: "preciousmeals-a7d59",
        storageBucket: "preciousmeals-a7d59.firebasestorage.app",
        messagingSenderId: "464759516900",
        appId: "1:464759516900:web:9a600a65fb1363f2b6c6f1",
        measurementId: "G-L0YMPEQ520"
      };

      // Initialize Firebase - this is just to ensure Firebase is initialized
      // The actual integration is in the firebase-config.js file
      const app = initializeApp(firebaseConfig);
    </script>
    
    <!-- Custom JavaScript -->
    <script type="module" src="./js/firebase-config.js"></script>
    <script type="module" src="./js/auth.js"></script>
    <script type="module" src="./js/booking.js"></script>
    <script type="module" src="./js/reviews.js"></script>

    <script>
        // Initialize AOS animations
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true
        });
        
        // Toggle between booking form and my bookings
        document.addEventListener('DOMContentLoaded', function() {
            const viewBookingsBtn = document.getElementById('viewBookingsBtn');
            const backToBookingBtn = document.getElementById('backToBookingBtn');
            const bookingSection = document.getElementById('booking');
            const myBookingsContainer = document.getElementById('myBookingsContainer');
            
            if (viewBookingsBtn && backToBookingBtn && bookingSection && myBookingsContainer) {
                viewBookingsBtn.addEventListener('click', function() {
                    bookingSection.classList.add('d-none');
                    myBookingsContainer.classList.remove('d-none');
                    // Load bookings
                    BookingSystem.loadUserBookings();
                });
                
                backToBookingBtn.addEventListener('click', function() {
                    myBookingsContainer.classList.add('d-none');
                    bookingSection.classList.remove('d-none');
                });
            }
        });
        // Login form logic for default credentials
        document.addEventListener('DOMContentLoaded', function() {
            const loginForm = document.getElementById('loginForm');
            const authMessage = document.getElementById('authMessage');
            const registerForm = document.getElementById('registerForm');
            const showRegisterBtn = document.getElementById('showRegisterBtn');
            const showLoginBtn = document.getElementById('showLoginBtn');
            
            // Switch between login and register forms
            if (showRegisterBtn) {
                showRegisterBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.getElementById('loginFormContainer').classList.add('d-none');
                    document.getElementById('registerFormContainer').classList.remove('d-none');
                    document.getElementById('authModalLabel').textContent = 'Create an Account';
                });
            }
            
            if (showLoginBtn) {
                showLoginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.getElementById('registerFormContainer').classList.add('d-none');
                    document.getElementById('loginFormContainer').classList.remove('d-none');
                    document.getElementById('authModalLabel').textContent = 'Login to Your Account';
                });
            }
            
            // Handle navigation bar login/register buttons
            const navLoginBtn = document.getElementById('navLoginBtn');
            const navRegisterBtn = document.getElementById('navRegisterBtn');
            
            if (navLoginBtn) {
                navLoginBtn.addEventListener('click', function() {
                    document.getElementById('registerFormContainer').classList.add('d-none');
                    document.getElementById('loginFormContainer').classList.remove('d-none');
                    document.getElementById('authModalLabel').textContent = 'Login to Your Account';
                });
            }
            
            if (navRegisterBtn) {
                navRegisterBtn.addEventListener('click', function() {
                    document.getElementById('loginFormContainer').classList.add('d-none');
                    document.getElementById('registerFormContainer').classList.remove('d-none');
                    document.getElementById('authModalLabel').textContent = 'Create an Account';
                });
            }
            
            // Handle login form submission
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const email = document.getElementById('loginEmail').value.trim();
                    const password = document.getElementById('loginPassword').value;
                    
                    if (!email || !password) {
                        showMessage('Please enter both email and password', 'error');
                        return;
                    }
                    
                    if (email === 'admin@admin.com' && password === 'password123') {
                        showMessage('Login successful! Welcome, Administrator.', 'success');
                        
                        // Store admin user in localStorage for session management
                        const adminUser = {
                            id: 'admin-' + Date.now(),
                            name: 'Administrator',
                            email: 'admin@admin.com'
                        };
                        localStorage.setItem('currentUser', JSON.stringify(adminUser));
                        
                        // Update username in navbar
                        updateUsernameInNavbar('Administrator');
                        
                        // Show booking interface
                        showBookingInterfaceAfterLogin();
                        
                        // Close modal after login
                        setTimeout(() => {
                            const modal = bootstrap.Modal.getInstance(document.getElementById('authModal'));
                            if (modal) modal.hide();
                        }, 1200);
                    } else {
                        showMessage('Invalid email or password.', 'error');
                    }
                });
            }
            
            // Handle register form submission
            if (registerForm) {
                registerForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const name = document.getElementById('registerName').value;
                    const email = document.getElementById('registerEmail').value;
                    const phone = document.getElementById('registerPhone').value;
                    const password = document.getElementById('registerPassword').value;
                    const confirmPassword = document.getElementById('confirmPassword').value;
                    
                    if (!name || !email || !phone || !password || !confirmPassword) {
                        showMessage('Please fill all fields', 'error');
                        return;
                    }
                    
                    if (password !== confirmPassword) {
                        showMessage('Passwords do not match', 'error');
                        return;
                    }
                    
                    if (password.length < 6) {
                        showMessage('Password must be at least 6 characters long', 'error');
                        return;
                    }
                    
                    // Email validation
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(email)) {
                        showMessage('Please enter a valid email address', 'error');
                        return;
                    }
                    
                    // Register user (simplified version without Firebase)
                    const newUser = {
                        id: 'user-' + Date.now(),
                        name: name,
                        email: email,
                        phone: phone
                    };
                    
                    // Store user in localStorage
                    localStorage.setItem('currentUser', JSON.stringify(newUser));
                    
                    // Update username in navbar
                    updateUsernameInNavbar(name);
                    
                    showMessage('Registration successful! You are now logged in.', 'success');
                    
                    // Show booking interface
                    showBookingInterfaceAfterLogin();
                    
                    // Close modal after registration
                    setTimeout(() => {
                        const modal = bootstrap.Modal.getInstance(document.getElementById('authModal'));
                        if (modal) modal.hide();
                    }, 1200);
                });
            }
            
            // Function to display messages
            function showMessage(message, type) {
                if (authMessage) {
                    authMessage.className = type === 'error' ? 'alert alert-danger' : 'alert alert-success';
                    authMessage.textContent = message;
                    authMessage.classList.remove('d-none');
                    
                    // Hide message after 3 seconds
                    setTimeout(() => {
                        authMessage.classList.add('d-none');
                    }, 3000);
                }
            }
            
            // Function to update username in navbar
            function updateUsernameInNavbar(name) {
                const userNameDisplay = document.querySelector('.user-name');
                if (userNameDisplay) {
                    userNameDisplay.textContent = name;
                }
                
                // Hide auth buttons and show user menu
                const authButtons = document.querySelector('.auth-buttons');
                const userMenu = document.querySelector('.user-menu');
                
                if (authButtons) authButtons.classList.add('d-none');
                if (userMenu) userMenu.classList.remove('d-none');
            }
            
            // Check if user is logged in on page load
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            if (currentUser && currentUser.name) {
                updateUsernameInNavbar(currentUser.name);
            }
            
            // Handle logout
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Clear user data
                    localStorage.removeItem('currentUser');
                    
                    // Show auth buttons and hide user menu
                    const authButtons = document.querySelector('.auth-buttons');
                    const userMenu = document.querySelector('.user-menu');
                    
                    if (authButtons) authButtons.classList.remove('d-none');
                    if (userMenu) userMenu.classList.add('d-none');
                    
                    // Redirect to home if on protected page
                    location.reload();
                });
            }
        });
            
            // Function to show booking interface after login
            function showBookingInterfaceAfterLogin() {
                // Hide login prompt and show booking form
                const loginPrompt = document.getElementById('loginPrompt');
                const bookingFormCard = document.getElementById('bookingFormCard');
                
                if (loginPrompt) {
                    loginPrompt.classList.add('d-none');
                }
                
                if (bookingFormCard) {
                    bookingFormCard.classList.remove('d-none');
                }
                
                // Show bookings calendar
                const bookingsCalendarContainer = document.getElementById('bookingsCalendarContainer');
                if (bookingsCalendarContainer) {
                    bookingsCalendarContainer.classList.remove('d-none');
                    // Initialize calendar
                    initializeBookingsCalendar();
                }
                
                // Show previous bookings
                const myBookingsContainer = document.getElementById('myBookingsContainer');
                if (myBookingsContainer) {
                    myBookingsContainer.classList.remove('d-none');
                    // Load user's bookings
                    if (typeof loadMyBookings === 'function') {
                        loadMyBookings();
                    }
                }
                
                // Show review section
                const reviewSection = document.getElementById('reviewSection');
                if (reviewSection) {
                    reviewSection.classList.remove('d-none');
                }
                
                // Show admin panel if admin is logged in
                const adminPanel = document.getElementById('adminPanel');
                const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                if (adminPanel && currentUser.email === 'admin@admin.com') {
                    adminPanel.classList.remove('d-none');
                    // Load all bookings for admin
                    if (typeof loadAllBookingsForAdmin === 'function') {
                        loadAllBookingsForAdmin();
                    }
                }
            }
            
            // Function to initialize bookings calendar
            function initializeBookingsCalendar() {
                const today = new Date();
                let currentMonth = today.getMonth();
                let currentYear = today.getFullYear();
                
                // Get DOM elements
                const calendarMonth = document.getElementById('calendarMonth');
                const calendarDays = document.getElementById('calendarDays');
                const prevMonthBtn = document.getElementById('prevMonthBtn');
                const nextMonthBtn = document.getElementById('nextMonthBtn');
                
                // Add event listeners for month navigation
                prevMonthBtn.addEventListener('click', () => {
                    currentMonth--;
                    if (currentMonth < 0) {
                        currentMonth = 11;
                        currentYear--;
                    }
                    renderCalendar(currentMonth, currentYear);
                });
                
                nextMonthBtn.addEventListener('click', () => {
                    currentMonth++;
                    if (currentMonth > 11) {
                        currentMonth = 0;
                        currentYear++;
                    }
                    renderCalendar(currentMonth, currentYear);
                });
                
                // Render the calendar
                function renderCalendar(month, year) {
                    // Update month/year display
                    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    calendarMonth.textContent = `${monthNames[month]} ${year}`;
                    
                    // Clear previous calendar days
                    calendarDays.innerHTML = '';
                    
                    // Get first day of month and number of days in month
                    const firstDay = new Date(year, month, 1).getDay();
                    const daysInMonth = new Date(year, month + 1, 0).getDate();
                    
                    // Get bookings from localStorage
                    const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
                    
                    // Previous month days
                    const prevMonthDays = new Date(year, month, 0).getDate();
                    for (let i = firstDay - 1; i >= 0; i--) {
                        const dayDiv = document.createElement('div');
                        dayDiv.className = 'calendar-day other-month';
                        dayDiv.innerHTML = `<div class="day-number">${prevMonthDays - i}</div>`;
                        calendarDays.appendChild(dayDiv);
                    }
                    
                    // Current month days
                    for (let i = 1; i <= daysInMonth; i++) {
                        const dayDiv = document.createElement('div');
                        dayDiv.className = 'calendar-day';
                        
                        // Check if this is today
                        const currentDate = new Date();
                        if (i === currentDate.getDate() && month === currentDate.getMonth() && year === currentDate.getFullYear()) {
                            dayDiv.classList.add('today');
                        }
                        
                        // Check if this day is in the past
                        const calendarDay = new Date(year, month, i);
                        if (calendarDay < new Date(currentDate.setHours(0, 0, 0, 0))) {
                            dayDiv.classList.add('past');
                        }
                        
                        dayDiv.innerHTML = `<div class="day-number">${i}</div>`;
                        
                        // Add bookings for this day
                        const dayBookings = bookings.filter(booking => {
                            const bookingDate = new Date(booking.date);
                            return bookingDate.getDate() === i && bookingDate.getMonth() === month && bookingDate.getFullYear() === year;
                        });
                        
                        if (dayBookings.length > 0) {
                            dayBookings.forEach(booking => {
                                const bookingItem = document.createElement('div');
                                bookingItem.className = 'booking-item';
                                bookingItem.textContent = `${booking.timeSlot} - ${booking.eventType}`;
                                bookingItem.setAttribute('data-booking-id', booking.id);
                                bookingItem.addEventListener('click', () => {
                                    // Show booking details
                                    if (typeof BookingSystem !== 'undefined' && BookingSystem.viewBookingDetails) {
                                        BookingSystem.viewBookingDetails(booking.id);
                                    }
                                });
                                dayDiv.appendChild(bookingItem);
                            });
                        }
                        
                        calendarDays.appendChild(dayDiv);
                    }
                    
                    // Next month days (to fill the grid)
                    const totalDaysShown = firstDay + daysInMonth;
                    const nextMonthDays = 42 - totalDaysShown; // 6 rows x 7 days = 42
                    for (let i = 1; i <= nextMonthDays; i++) {
                        const dayDiv = document.createElement('div');
                        dayDiv.className = 'calendar-day other-month';
                        dayDiv.innerHTML = `<div class="day-number">${i}</div>`;
                        calendarDays.appendChild(dayDiv);
                    }
                }
                
                // Initial calendar render
                renderCalendar(currentMonth, currentYear);
            }
            
            // Check if user is already logged in and show appropriate UI
            document.addEventListener('DOMContentLoaded', function() {
                if (localStorage.getItem('currentUser')) {
                    showBookingInterfaceAfterLogin();
                }
            });
            
            // Function to load all bookings for admin panel
            function loadAllBookingsForAdmin() {
                const allBookingsList = document.getElementById('allBookingsList');
                if (!allBookingsList) return;
                
                const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
                
                if (bookings.length === 0) {
                    allBookingsList.innerHTML = '<tr><td colspan="7" class="text-center">No bookings found</td></tr>';
                    return;
                }
                
                // Sort bookings by date (newest first)
                bookings.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                allBookingsList.innerHTML = '';
                bookings.forEach(booking => {
                    const row = document.createElement('tr');
                    
                    // Format date
                    const bookingDate = new Date(booking.date);
                    const formattedDate = bookingDate.toLocaleDateString();
                    
                    // Status badge class
                    let statusClass = '';
                    switch(booking.status) {
                        case 'pending':
                            statusClass = 'status-pending';
                            break;
                        case 'confirmed':
                            statusClass = 'status-confirmed';
                            break;
                        case 'cancelled':
                            statusClass = 'status-cancelled';
                            break;
                    }
                    
                    // Get user name and contact info with fallbacks
                    const userName = booking.userName || (booking.user && booking.user.name) || 'Unknown';
                    const userEmail = booking.userEmail || (booking.user && booking.user.email) || 'No email';
                    const userPhone = booking.userPhone || (booking.user && booking.user.phone) || 'N/A';
                    const eventType = booking.eventType || booking['Event Type'] || 'N/A';
                    const guestCount = booking.guestCount || booking.Guests || (booking['Guests'] ? booking['Guests'] : '0');
                    const bookingStatus = booking.status || booking.Status || 'Pending';
                    
                    row.innerHTML = `
                        <td>${formattedDate}<br><small class="text-muted">${booking.timeSlot || 'No time'}</small></td>
                        <td>${userName}</td>
                        <td>
                            <small><i class="bi bi-envelope"></i> ${userEmail}</small><br>
                            <small><i class="bi bi-telephone"></i> ${userPhone}</small>
                        </td>
                        <td>${eventType}</td>
                        <td>${guestCount}</td>
                        <td><span class="booking-status ${statusClass}">${bookingStatus}</span></td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-success confirm-booking-btn" data-booking-id="${booking.id}" title="Confirm Booking">
                                    <i class="bi bi-check-circle"></i>
                                </button>
                                <button class="btn btn-outline-danger cancel-booking-btn" data-booking-id="${booking.id}" title="Cancel Booking">
                                    <i class="bi bi-x-circle"></i>
                                </button>
                                <button class="btn btn-outline-primary view-booking-btn" data-booking-id="${booking.id}" title="View Details">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    allBookingsList.appendChild(row);
                });
                
                // Add event listeners for booking action buttons
                document.querySelectorAll('.confirm-booking-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        updateBookingStatus(this.getAttribute('data-booking-id'), 'confirmed');
                    });
                });
                
                document.querySelectorAll('.cancel-booking-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        updateBookingStatus(this.getAttribute('data-booking-id'), 'cancelled');
                    });
                });
                
                document.querySelectorAll('.view-booking-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        if (typeof BookingSystem !== 'undefined' && BookingSystem.viewBookingDetails) {
                            BookingSystem.viewBookingDetails(this.getAttribute('data-booking-id'));
                        }
                    });
                });
            }
            
            // Function to update booking status (for admin)
            function updateBookingStatus(bookingId, newStatus) {
                const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
                const bookingIndex = bookings.findIndex(b => b.id === bookingId);
                
                if (bookingIndex !== -1) {
                    bookings[bookingIndex].status = newStatus;
                    localStorage.setItem('bookings', JSON.stringify(bookings));
                    
                    // Reload bookings in admin panel
                    loadAllBookingsForAdmin();
                    
                    // Also refresh user's bookings if they match the current user
                    const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                    if (bookings[bookingIndex].userId === currentUser.id && typeof BookingSystem !== 'undefined') {
                        BookingSystem.loadUserBookings();
                    }
                    
                    // Refresh calendar
                    if (typeof initializeBookingsCalendar === 'function') {
                        initializeBookingsCalendar();
                    }
                }
            }
        
    </script>
    
    <!-- Local Database Scripts -->
    <script type="module">
      // Import database functions from our hybrid database.js
      import { 
          collection, 
          addDoc,
          getDocs,
          query,
          where,
          orderBy,
          deleteDoc,
          doc,
          getDoc,
          updateDoc,
          HybridDatabase
      } from "./database/database.js";
      
      // Sync bookings with server on page load
      window.addEventListener('DOMContentLoaded', async () => {
        try {
          console.log('Syncing bookings with server...');
          await HybridDatabase.sync.syncBidirectional('bookings');
          console.log('Bookings synced successfully!');
        } catch (error) {
          console.warn('Failed to sync bookings with server:', error);
        }
      });

      // Form submission
      document.getElementById("bookingForm").addEventListener("submit", async function(e) {
        e.preventDefault();
        
        // Get form values
        const eventType = document.getElementById("eventType").value;
        const eventDate = document.getElementById("eventDate").value;
        const guestCount = document.getElementById("guestCount").value;
        const fullName = document.getElementById("fullName").value;
        const email = document.getElementById("email").value;
        const phone = document.getElementById("phone").value;
        const timeSlot = document.getElementById("timeSlot").value;
        const specialRequests = document.getElementById("specialRequests").value;
        
        try {
          // Create new booking document
          const bookingData = {
            "Event Type": eventType,
            "Event Date": eventDate,
            "Guests": guestCount,
            "Time": timeSlot || new Date().toISOString(),
            "Status": "Pending",
            "userEmail": email,
            "userName": fullName,
            "userPhone": phone,
            "specialRequests": specialRequests
          };
          
          console.log("Submitting booking data:", bookingData);
          
          // Add to collection (this will automatically sync with server)
          const bookingsRef = collection("bookings");
          const newBooking = await addDoc(bookingsRef, bookingData);
          
          console.log("Booking added with ID:", newBooking.id);
          
          // Show success message
          document.getElementById("bookingSuccessMessage").classList.remove("d-none");
          document.getElementById("bookingSuccessMessage").innerHTML = '<i class="bi bi-check-circle-fill me-2"></i> Your booking request has been submitted successfully and synced online! We will contact you shortly to confirm your booking.';
          
          // Reset form
          document.getElementById("bookingForm").reset();
          
          // Hide success message after 5 seconds
          setTimeout(() => {
            document.getElementById("bookingSuccessMessage").classList.add("d-none");
          }, 5000);
        } catch (error) {
          console.error("Error adding booking: ", error);
          alert("Failed to submit booking. Error: " + error.message);
        }
      });
      
      // Function to show My Bookings section and load data
      async function loadMyBookings() {
        // Get the My Bookings container and booking section
        const myBookingsContainer = document.getElementById('myBookingsContainer');
        const bookingSection = document.getElementById('booking');
        
        // Show the My Bookings section and hide the booking form
        if (myBookingsContainer && bookingSection) {
          myBookingsContainer.classList.remove('d-none');
          bookingSection.classList.add('d-none');
        }
        
        // Get reference to bookings list and no bookings message
        const bookingsList = document.getElementById('bookingsList');
        const noBookingsMessage = document.getElementById('noBookingsMessage');
        
        if (!bookingsList) return;
        
        try {
          // Clear existing bookings
          bookingsList.innerHTML = '';
          
          console.log('Loading bookings...');
          
          // Get current user email from form or use a default
          const emailInput = document.getElementById('email');
          const userEmail = emailInput ? emailInput.value : '';
          
          // Get all bookings from our database
          const bookingsRef = collection("bookings");
          let querySnapshot;
          
          if (userEmail) {
            // Filter by user email if available
            console.log('Filtering bookings for email:', userEmail);
            const q = query(collection("bookings"), where("userEmail", "==", userEmail));
            querySnapshot = await getDocs(q);
          } else {
            // Otherwise get all bookings
            console.log('Loading all bookings');
            querySnapshot = await getDocs(bookingsRef);
          }
          
          console.log('Found', querySnapshot.size, 'bookings');
          let hasBookings = false;
          
          // Process each booking
          querySnapshot.forEach((doc) => {
            hasBookings = true;
            const booking = doc.data();
            const bookingId = doc.id;
            console.log('Processing booking:', bookingId, booking);
            
            // Format date nicely
            let eventDate = booking["Event Date"] || "N/A";
            
            // Format time nicely
            let bookingTime = booking["Time"] || "N/A";
            // If it's an ISO string, format it
            if (typeof bookingTime === 'string' && bookingTime.includes('T')) {
              try {
                const timeObj = new Date(bookingTime);
                bookingTime = timeObj.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
              } catch (e) {
                // Keep original value if parsing fails
              }
            }
            
            // Create booking row
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${eventDate}</td>
              <td>${booking["Event Type"] || "N/A"}</td>
              <td>${bookingTime}</td>
              <td>${booking["Guests"] || "N/A"}</td>
              <td>
                <span class="badge ${booking["Status"] === "Confirmed" ? "bg-success" : "bg-warning"}">
                  ${booking["Status"] || "Pending"}
                </span>
              </td>
              <td>
                <button class="btn btn-sm btn-outline-primary view-booking-btn" data-booking-id="${bookingId}">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger cancel-booking-btn" data-booking-id="${bookingId}">
                  <i class="bi bi-x-circle"></i>
                </button>
              </td>
            `;
            
            bookingsList.appendChild(row);
          });
          
          console.log('Bookings display complete, hasBookings:', hasBookings);
          
          // Show or hide the no bookings message
          if (noBookingsMessage) {
            if (hasBookings) {
              noBookingsMessage.classList.add('d-none');
            } else {
              noBookingsMessage.classList.remove('d-none');
            }
          }
          
          // Add event listeners for the view and cancel buttons
          document.querySelectorAll('.view-booking-btn').forEach(btn => {
            btn.addEventListener('click', function() {
              const bookingId = this.getAttribute('data-booking-id');
              // Implement view booking details functionality
              const docRef = doc(collection("bookings"), bookingId);
              
              // Get booking details
              getDoc(docRef).then((docSnap) => {
                if (docSnap.exists()) {
                  const bookingData = docSnap.data();
                  console.log('Viewing booking details:', bookingData);
                  
                  // Create modal if it doesn't exist
                  let modal = document.getElementById('bookingDetailsModal');
                  if (!modal) {
                    modal = document.createElement('div');
                    modal.id = 'bookingDetailsModal';
                    modal.className = 'modal fade';
                    modal.setAttribute('tabindex', '-1');
                    modal.setAttribute('aria-hidden', 'true');
                    modal.innerHTML = `
                      <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title">Booking Details</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                          </div>
                          <div class="modal-body" id="bookingDetailsContent"></div>
                        </div>
                      </div>
                    `;
                    document.body.appendChild(modal);
                  }
                  
                  // Format time if it's an ISO string
                  let formattedTime = bookingData["Time"] || 'N/A';
                  if (typeof formattedTime === 'string' && formattedTime.includes('T')) {
                    try {
                      const timeObj = new Date(formattedTime);
                      formattedTime = timeObj.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    } catch (e) {
                      // Keep original value if parsing fails
                    }
                  }
                  
                  // Update modal content
                  const content = document.getElementById('bookingDetailsContent');
                  content.innerHTML = `
                    <p><strong>Name:</strong> ${bookingData["userName"] || 'N/A'}</p>
                    <p><strong>Email:</strong> ${bookingData["userEmail"] || 'N/A'}</p>
                    <p><strong>Phone:</strong> ${bookingData["userPhone"] || 'N/A'}</p>
                    <p><strong>Event Type:</strong> ${bookingData["Event Type"] || 'N/A'}</p>
                    <p><strong>Date:</strong> ${bookingData["Event Date"] || 'N/A'}</p>
                    <p><strong>Time:</strong> ${formattedTime}</p>
                    <p><strong>Number of Guests:</strong> ${bookingData["Guests"] || 'N/A'}</p>
                    <p><strong>Special Requests:</strong> ${bookingData["specialRequests"] || 'None'}</p>
                    <p><strong>Status:</strong> <span class="badge ${bookingData["Status"] === "Confirmed" ? "bg-success" : "bg-warning"}">${bookingData["Status"] || 'Pending'}</span></p>
                  `;
                  
                  // Show the modal
                  const modalInstance = new bootstrap.Modal(modal);
                  modalInstance.show();
                } else {
                  console.error('No booking found with ID:', bookingId);
                  alert('Booking not found!');
                }
              }).catch(error => {
                console.error('Error getting booking details:', error);
                alert('Failed to load booking details.');
              });
            });
          });
          
          document.querySelectorAll('.cancel-booking-btn').forEach(btn => {
            btn.addEventListener('click', async function() {
              const bookingId = this.getAttribute('data-booking-id');
              if (confirm('Are you sure you want to cancel this booking?')) {
                // Implement cancel booking functionality
                const docRef = doc(collection("bookings"), bookingId);
                
                deleteDoc(docRef).then(() => {
                  alert('Booking canceled successfully!');
                  // Reload bookings list
                  loadMyBookings();
                }).catch(error => {
                  console.error('Error canceling booking:', error);
                  alert('Failed to cancel booking.');
                });
              }
            });
          });
          
        } catch (error) {
          console.error('Error loading bookings:', error);
          alert('Failed to load bookings.');
        }
      }
      
      // Add event listener to "My Bookings" buttons
      const myBookingsNavBtn = document.querySelector('a[href="#myBookings"]');
      if (myBookingsNavBtn) {
        myBookingsNavBtn.addEventListener('click', function(e) {
          e.preventDefault();
          loadMyBookings();
        });
      }
      
      // Add event listener to the "My Bookings" button in the form
      const viewMyBookingsBtn = document.getElementById('viewMyBookingsBtn');
      if (viewMyBookingsBtn) {
        viewMyBookingsBtn.addEventListener('click', function() {
          loadMyBookings();
        });
      }
      
      // Add event listener to "Back to Booking" button
      const backToBookingBtn = document.getElementById('backToBookingBtn');
      if (backToBookingBtn) {
        backToBookingBtn.addEventListener('click', function() {
          document.getElementById('myBookingsContainer').classList.add('d-none');
          document.getElementById('booking').classList.remove('d-none');
        });
      }
    </script>
</body>
</html>
